{% extends "base_template.html" %}
{% block steps %}
<li><a href="/" class="router-link-active">Início</a></li>
<li class="is-active"><a href="{% url "blog:blog-home" %}"
        class="router-link-exact-active router-link-active">Notificações</a></li>
{% endblock %}
{% block content %}

<div data-v-8716d23a="" class="columns">
    <div class="column is-3">
        <div data-v-1513178e="">
            <form>
            <div data-v-1513178e="" class="menu">
                <p data-v-1513178e="" class="menu-label">Filtros Utilizador</p>
                <ul data-v-1513178e="" class="menu-list">

                    <div data-v-1513178e="" class="field">
                        <!---->
                        <form>
                        <div data-v-1513178e="" class="autocomplete control">
                            <div class="control has-icons-left is-clearfix"><input type="text" id="myInput"
                                     autocomplete="off" placeholder="Email do Utilizador"
                                    class="input">
                                <span class="icon is-left"><i class="mdi mdi-magnify mdi-24px"></i></span>
                                <!---->
                                <!---->
                            </div>
                        </div>
                        <!---->
                    </div>
                    <div data-v-1513178e="" class="field">
                        <!---->
                        <div data-v-1513178e="" class="autocomplete control">
                            <div class="control has-icons-left is-clearfix"><input type="text" id="myInput2"
                                     autocomplete="off" placeholder="Titulo da notificação"
                                    class="input">
                                <span class="icon is-left"><i class="mdi mdi-magnify mdi-24px"></i></span>
                                <!---->
                                <!---->
                            </div>
                        </div>
                        <!---->
                    </div>
                    <li class="is-not-menu" ><a style="background-color: white; color: black;" class="is-active" onclick="press()">
                            <!----> <span class="icon is-pulled-right"><i id="plus"
                                    class="mdi mdi-plus mdi-24px"></i></span><small >Mais Filtros de
                                Notificação</small></a>
                        <ul style="display: none;" id="panel">
                            <div class="field">
                                <!---->
                                <div class="datepicker control">
                                    <div class="dropdown is-mobile-modal">
                                        <div role="button" aria-haspopup="true" class="dropdown-trigger">
                                            <div class="control has-icons-left is-clearfix input-daterange">
                                                <input type="date" id="datefilterfrom" data-date-split-input="true"
                                                    class="input"> <span class="icon is-left"><i
                                                        class="mdi mdi-calendar-today mdi-24px"></i></span>
                                                <!---->
                                                <!---->
                                            </div>
                                        </div>
                                        <div class="background" style="display: none;" aria-hidden="true">
                                        </div>
                                        <div class="dropdown-menu" style="display: none;" aria-hidden="true">
                                            <div class="dropdown-content">
                                                <div tabindex="0" class="dropdown-item">
                                                    <header class="datepicker-header">
                                                        <div class="pagination field is-centered"><a role="button"
                                                                href="#" class="pagination-previous"><span
                                                                    class="icon has-text-primary is"><i
                                                                        class="mdi mdi-chevron-left mdi-24px"></i></span></a>
                                                            <a role="button" href="#" class="pagination-next"><span
                                                                    class="icon has-text-primary is"><i
                                                                        class="mdi mdi-chevron-right mdi-24px"></i></span></a>
                                                            <!---->
                                                        </div>
                                                    </header>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!---->
                                </div>
                                <br>
                                <div class="field">
                                    <!---->
                                    <div class="datepicker control">
                                        <div class="dropdown is-mobile-modal">
                                            <div role="button" aria-haspopup="true" class="dropdown-trigger">
                                                <div class="control has-icons-left is-clearfix"><input type="date"
                                                        id="datefilterto" data-date-split-input="true" class="input">
                                                    <span class="icon is-left date-range-filter"><i
                                                            class="mdi mdi-calendar-today mdi-24px"></i></span>
                                                    <!---->
                                                    <!---->
                                                    <div aria-hidden="true" class="background" style="display: none;">
                                                    </div>
                                                    <div aria-hidden="true" class="dropdown-menu"
                                                        style="display: none;">
                                                        <div class="dropdown-content">
                                                            <div tabindex="0" class="dropdown-item">
                                                                <header class="datepicker-header">
                                                                    <div class="pagination field is-centered">
                                                                        <a role="button" href="#"
                                                                            class="pagination-previous"><span
                                                                                class="icon has-text-primary is"><i
                                                                                    class="mdi mdi-chevron-left mdi-24px"></i></span></a>
                                                                        <a role="button" href="#"
                                                                            class="pagination-next"><span
                                                                                class="icon has-text-primary is"><i
                                                                                    class="mdi mdi-chevron-right mdi-24px"></i></span></a>
                                                                        <!---->
                                                                    </div>
                                                                </header>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!---->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ul>
                        <br>
                        <button class="button is-outlined is-link is-danger"  type="submit">
                            <span>Limpar</span>
                            <span class="icon is-medium"><i class="mdi mdi-broom"></i></span>
                        </button>
                    </li>
                </form>
                </ul>
            </div>
            </form>

        </div>
    </div>
    <div class="column">
        <a href="{% url "create_not" %}" class="button is-success is-outlined" type="button"
            style="margin-bottom: 0.9rem; margin-right: 1rem;text-decoration:none;"><span class="icon is-small"><i
                    class="mdi mdi-plus"></i></span> <span> Nova Notificação </span>
            <!----></a>
            {% if my %}
        <a href="{% url "check_not" %}" class="button is-success is-outlined" type="button"
            style="margin-bottom: 0.9rem; margin-right: 1rem;text-decoration:none;"><span class="icon is-small"><i
                    class="mdi mdi-send"></i></span> <span> Notificações Recebidas
            </span>
            <!----></a>
            {% else %}
            <a href="{% url "check_not_enviadas" %}" class="button is-success is-outlined" type="button"
                style="margin-bottom: 0.9rem; margin-right: 1rem;text-decoration:none;"><span class="icon is-small"><i
                        class="mdi mdi-send"></i></span> <span> Notificações enviadas
                </span>
                <!----></a>
                {% endif %}
        <button class="button button4 is-danger is-outlined" id="button" data-toggle="modal" data-target="#exampleModal" data-backdrop="false"
            style="margin-bottom: 0.9rem; margin-right: 1rem;text-decoration:none;"><span class="icon is-small"><i
                    class="mdi mdi-close"></i></span> <span> Eliminar
                selecionadas </span>
            <!----></button>

        <div class="b-table">
            <div class="field table-mobile-sort">
                <div class="field has-addons">
                    <div class="control is-expanded"><span class="select is-fullwidth"><select>
                                <!---->
                                <!---->
                                <option value="[object Object]">
                                    Nome
                                </option>
                                <option value="[object Object]">
                                    Tipo
                                </option>
                                <option value="[object Object]">
                                    Estado
                                </option>
                                <!---->
                            </select></span>
                        <!---->
                    </div>
                    <div class="control"><button class="button is-primary"><span class="icon is-small"><i
                                    class="mdi mdi-menu-up"></i></span></button>
                    </div>
                </div>
            </div>
            <!---->
            <form method='POST' id="myform">
                {% csrf_token %}
                <div class="table-wrapper">
                    <table id="myTable" class="table table-striped">
                        <thead>
                            <tr>

                                <!---->

                                <th class="is-sortable">
                                    <div class="th-wrap th-sm">{% if my %} Receptor {% else %} Emissor
                                        {% endif %} <span class="icon is-small" style="display: none;"><i
                                                class="mdi mdi-menu-up"></i></span>
                                    </div>
                                </th>
                                <th class="is-sortable">
                                    <div class="th-wrap th-sm">Titulo da Notificação<span class="icon is-small"
                                            style="display: none;"><i class="mdi mdi-menu-up"></i></span>
                                    </div>
                                </th>
                                <th class="is-sortable th-sm">
                                    <div class="th-wrap th-sm"> Data Emissão <span class="icon is-small"
                                            style="display: none;"><i class="mdi mdi-menu-up"></i></span>
                                    </div>
                                </th>
                                <th class="">
                                    <div class="th-wrap is-centered">Ações <input class="checkbox_extra" type="checkbox" name='press'
                                            value="all" onclick="checkAll()"
                                            style="transform: scale(1.2); margin-left: 3%;"></span><span
                                            class="icon is-small" style="display: none;"><i class="mdi mdi-menu-up"></i>
                                        </span>
                                    </div>
                                </th>
                                <!---->
                            </tr>
                            <!---->
                            <!---->
                        </thead>
                        <tbody>
                            {% for not in nots %}
                            {% if not.notificacao.idutilizadorenvia == me_id and my%}
                            {% include "tabela_de_consulta.html" %}
                            {% elif not.notificacao.utilizadorrecebe == me_id%}
                            {% include "tabela_de_consulta.html" %}
                            {% endif %}
                            </tr>
                            <!---->
                            <!---->
                            <!---->
                            <!---->
                            {% endfor %}


                        </tbody>
                        <!---->
                    </table>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    $('#exampleModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget) // Button that triggered the modal
        var recipient = button.data('whatever') // Extract info from data-* attributes
        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        var modal = $(this)
        modal.find('.modal-title').text('New message to ' + recipient)
        modal.find('.modal-body input').val(recipient)
    })
</script>

<script>
    var table=0;
    $(document).ready(function () {
       table= $('#myTable').DataTable({
            "paging": true,
            "info": false,
            "dom": 'tp',
            "bLengthChange": false,
            "aLengthMenu": [[5, 10, 25, -1], [5, 10, 25, "All"]],
            "columnDefs": [
                { "orderable": false, "targets": [0, 3] }
            ]
        });
        $('#myInput').on('keyup', function () {
        console.log($(this).val())
        table.column(0).search($(this).val()).draw();
        if($(this).val()=='')
            $(this).css({"color":"hsla(0,0%,47.8%,.7)"});
        else
            $(this).css({"color":"black"});
    });
    $('#myInput2').on('keyup', function () {
        table.column(1).search($(this).val()).draw();
        if($(this).val()=='')
            $(this).css({"color":"hsla(0,0%,47.8%,.7)"});
        else
            $(this).css({"color":"black"});
    });
    });
</script>

    </section>
                <div class="dialog modal" id="exampleModal">
                    <div class="modal-background"></div>
                    <br><br><br><br><br><br><br><br><br><br><br><br>
                    <div class="modal-card animation" style="max-width:360px">
                        <!---->
                        <section class="modal-card-body is-titleless">
                            <div class="media">
                                <!---->
                                <div class="media-content">
                                    <p>Tem a certeza que pretende eliminar?</p>
                                    <!---->
                                </div>
                            </div>
                        </section>
                        <footer class="modal-card-foot"><button class="button" data-dismiss="modal">
                                Cancelar
                            </button> <button class="button is-success" type="submit" form="myform">
                                Confirmar
                            </button></footer>
                    </div>
                </div>
    </div>
</div>
<script>
    $(function () {
        $('#campus').on('change', function () {
            var val = this.value;
            $('#myInput3 option').hide().filter(function () {
                return this.value.indexOf(val + '_') === 0;
            })
                .show();
        })
            .change();
    });
</script>
<script>
    function myFunctionslect() {
        var checkBox = document.getElementById("myCheck");
        var text = document.getElementById("text");
        if (checkBox.checked == true) {
            text.style.display = "block";
        } else {
            text.style.display = "none";
        }
    }
    var isChecked = false;
    function checkAll() {
        var checkboxes = document.getElementsByTagName('input');
        if (isChecked) {
            for (var i = 0; i < checkboxes.length; i++) {
                if (checkboxes[i].type == 'checkbox') {
                    checkboxes[i].checked = true;
                }
            }
        } else {
            for (var i = 0; i < checkboxes.length; i++) {
                console.log(i)
                if (checkboxes[i].type == 'checkbox') {
                    checkboxes[i].checked = false;
                }
            }
        }
        isChecked = !isChecked;
    }
    function press() {
        if (document.getElementById('panel').style.display == 'none') {
            document.getElementById("panel").style.display = "block";
            document.getElementById('plus').classList.remove("mdi-plus");
            document.getElementById('plus').classList.add('mdi-minus');
        }

        else {
            document.getElementById("panel").style.display = "none";
            document.getElementById('plus').classList.remove("mdi-minus");
            document.getElementById('plus').classList.add('mdi-plus');
        }

    }
    function filterRows() {
        var from = $('#datefilterfrom').val();
        var to = $('#datefilterto').val();
        from = from || '1970-01-01'; // default from to a old date if it is not set
        to = to || '2999-12-31';
        console.log(from)
        var dateFrom = moment(from)
        var dateTo = moment(to)
        console.log(dateFrom);
        $('#myTable tr').each(function (i, tr) {
            var val = $(tr).find("td:nth-child(3)").text();
            var dateVal = moment(val, "DD/MM/YYYY");
            var visible = (dateVal.isBetween(dateFrom, dateTo, null, [])) ? "" : "none"; // [] for inclusive
            $(tr).css('display', visible);
        });
    }

    $('#datefilterfrom').on("change", filterRows);
    $('#datefilterto').on("change", filterRows);
</script>

<script>
 
    $( document ).ready(function(){
    $(".checkbox_extra").on("change",func);
    func();
    });
     
    function func(){
    var bool_test = false;
    $(".checkbox_extra").each(function(){
        if($(this).is(":checked")){
            bool_test = true
        }
    });
    if(bool_test == true){
        $("#button").show()
    }else{
        $("#button").hide()
    }
}
     
    </script>
    <script>
        {% for user in users %}
        $("#color_me{{ forloop.counter }}").change(function () {
            var color = $("option:selected", this).attr("class");
            $("#color_me").attr("class", color);
        });
        {% endfor %}
    </script>

{% endblock content %}