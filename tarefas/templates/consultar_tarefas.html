{% extends "base_template.html" %}
{% load ins_form_tags %}
{% block steps %}
<li><a href="/" class="router-link-active">Início</a></li>
<li class="is-active"><a href="{% url "blog:blog-home" %}"
        class="router-link-exact-active router-link-active">Disponibilidade</a></li>
{% endblock %}
{% block content %}
<div data-v-8716d23a="" class="columns">
    <div class="table-wrapper">
        <form id="regForm" method="POST">
            {% csrf_token %}
            <table id="myTable" class="table table-striped">
                <thead>
                    <tr>
                        <!---->
                        <th class="is-sortable">
                            <div class="th-wrap"> Dia <span class="icon is-small" style="display: none;"><i
                                        class="mdi mdi-menu-up"></i></span>
                            </div>
                        </th>
                        <th class="is-sortable">
                            <div class="th-wrap"> Hora Início <span class="icon is-small" style="display: none;"><i
                                        class="mdi mdi-menu-up"></i></span>
                            </div>
                        </th>
                        <th class="is-sortable">
                            <div class="th-wrap"> Hora Final <span class="icon is-small" style="display: none;"><i
                                        class="mdi mdi-menu-up"></i></span>
                            </div>
                        </th>
                        <th class="is-sortable">
                            <div class="th-wrap"> Tipo Tarefa <span class="icon is-small" style="display: none;"><i
                                        class="mdi mdi-menu-up"></i></span>
                            </div>
                        </th>
                        <th class="is-sortable">
                            <div class="th-wrap"> Ação <span class="icon is-small" style="display: none;"><i
                                        class="mdi mdi-menu-up"></i></span>
                            </div>
                        </th>
                        <!---->
                    </tr>
                    <!---->
                    <!---->
                </thead>
                {{ form.management_form }}
                <tbody id="disponibilidade">
                    {% for disponibilidade in form %}
                    <tr draggable="false" class="" scope="row">
                        <!---->
                        <td data-label="Dia" class="">
                            {{ disponibilidade.dia_dia }}
                        </td>
                        <td data-label="Hora Início" class="">
                            {{ disponibilidade.horario_hora }}
                        </td>
                        <td data-label="Hora Final" class="">
                            {{ disponibilidade.horario_hora1 }}
                        </td>
                        <td data-label="Tipo Tarefa" class="">
                            <select name="{{ disponibilidade.tipo_de_tarefa.html_name }}" id="{{ disponibilidade.tipo_de_tarefa.id_for_label }}">
                                <option value="None" selected="">---------</option>

                                <option value="Guiar Grupo">Guiar Grupo</option>

                                <option value="Ajudar Docente">Ajudar Docente</option>

                            </select>
                        </td>
                        <td data-label="Ações" class="">
                            <a role="button" class="table_remove_button" data-toggle="modal" data-target="#{{ forloop.counter }}">
                                <span class="icon has-text-danger">
                                    <i class="mdi mdi-close-box mdi-24px"></i>
                                </span>
                            </a>
                            {{disponibilidade.DELETE | addcss:"hide" }}  
                        </td>
                    </tr>
                    {% endfor %}
                    <!---->
                    <!---->
                    <!---->
                    <!---->
                </tbody>
                <!---->
            </table>

            <!--TEMPLATE FOR ADD MORE REPONSAVEIS-->
            <table style="display:none">
                <tbody id="template_disponibilidade">
                    <tr draggable="false" class="" scope="row">
                        <!---->
                        <td data-label="Dia" class="">
                            {{form.empty_form.dia_dia}}
                        </td>
                        <td data-label="Hora Início" class="">
                            {{form.empty_form.horario_hora}}
                        </td>
                        <td data-label="Hora Final" class="">
                            {{form.empty_form.horario_hora1}}
                        </td>
                        <td data-label="Tipo Tarefa" class="">
                            <select name="{{ form.empty_form.tipo_de_tarefa.html_name }}"
                                id="{{ form.empty_form.tipo_de_tarefa.id_for_label }}">
                                <option value="None" selected="">---------</option>

                                <option value="Guiar Grupo">Guiar Grupo</option>

                                <option value="Ajudar Docente">Ajudar Docente</option>

                            </select>
                        </td>
                        <td data-label="Ações" class="">
                            <a role="button" class="table_remove_button" data-toggle="modal" data-target="#{{ forloop.counter }}">
                                <span class="icon has-text-danger">
                                    <i class="mdi mdi-close-box mdi-24px"></i>
                                </span>
                            </a>
                            {{form.empty_form.DELETE | addcss:"hide" }}
                        </td>
                    </tr>
                </tbody>
            </table>

            <!--END TEMPLATE-->
            <br>
            <button type="button" class="button" onclick="add_responsavel()">
                <span class="icon is-small"><i class="mdi mdi-plus"></i></span>
                <span>Adicionar disponibilidade</span>
            </button>

            <button type="submit">
                <span class="icon is-small"><i class="mdi mdi-plus"></i></span>
                <span>Submeter</span>
            </button>
        </form>
    </div>
</div>


<script>

        $(document).ready(function () 
        {
            $('.table_remove_button').each(function(){
                applyClickRemoveRow($(this));
            });
        });

    function add_responsavel() {
        var value = parseInt($('#id_tarefa-TOTAL_FORMS').val());
        $('#id_tarefa-TOTAL_FORMS').val(value + 1);

        var form_idx = $('#disponibilidade').children().length;
        var template = $('#template_disponibilidade').clone(true);

        var mertens = $('#disponibilidade').append(template.html().replace(/__prefix__/g, form_idx));

        applyClickRemoveRow(mertens.find('.table_remove_button'));
    }

    function applyClickRemoveRow(el){
        el.on('click',function(){
            $(this).next('input').prop( "checked", true );
            $(this).next('input').val(1);
            $(this).closest('tr').hide();
        });
    }

</script>

{% endblock content %}